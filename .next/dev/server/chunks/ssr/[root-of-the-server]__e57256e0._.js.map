{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["file:///Users/mauriciomendoza/Desktop/lou-re-3d-core/components/ModelViewer.jsx"],"sourcesContent":["import { useEffect, useRef } from \"react\";\nimport * as THREE from \"three\";\nimport { GLTFLoader } from \"three/examples/jsm/loaders/GLTFLoader.js\";\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\n\nconst FLOOR_Y = 0;\nconst LAYOUT_KEY = \"lou-re-furniture-layout-v1\";\nconst ROOM_ID = \"demo-room-1\"; // later you can make this dynamic per room/upload\n\nexport default function ModelViewer({ file }) {\n  const containerRef = useRef(null);\n  const furnitureHelpersRef = useRef({\n    addSofa: null,\n    addTable: null,\n    addPlant: null,\n    clearFurniture: null,\n    saveCloud: null,\n    loadCloud: null,\n  });\n  const furnitureGroupRef = useRef(null);\n  const controlsRef = useRef(null);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    // --- basic sizes based on container, not whole window ---\n    const width = container.clientWidth || window.innerWidth;\n    const height = container.clientHeight || window.innerHeight;\n\n    const scene = new THREE.Scene();\n    scene.background = new THREE.Color(0x111111);\n\n    const camera = new THREE.PerspectiveCamera(50, width / height, 0.1, 1000);\n    camera.position.set(0, 1.6, 4); // ~human height\n\n    const renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(width, height);\n    container.appendChild(renderer.domElement);\n\n    const ambientLight = new THREE.AmbientLight(0xffffff, 1.2);\n    scene.add(ambientLight);\n\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 3);\n    directionalLight.position.set(5, 10, 7);\n    scene.add(directionalLight);\n\n    const furnitureGroup = new THREE.Group();\n    scene.add(furnitureGroup);\n    furnitureGroupRef.current = furnitureGroup;\n\n    let roomCenter = new THREE.Vector3(0, 0, 0);\n    const ROTATION_STEP = Math.PI / 16;\n\n    const raycaster = new THREE.Raycaster();\n    const pointer = new THREE.Vector2();\n    const dragPlane = new THREE.Plane(new THREE.Vector3(0, 1, 0), -FLOOR_Y);\n    let selectedFurniture = null;\n    let isDragging = false;\n\n    // -----------------------\n    // Layout helpers\n    // -----------------------\n    function getCurrentLayout() {\n      if (!furnitureGroupRef.current) return [];\n      return furnitureGroupRef.current.children\n        .map((child) => {\n          const type = child.userData?.furnitureType;\n          if (!type) return null;\n          return {\n            type,\n            position: child.position.toArray(),\n            rotation: [child.rotation.x, child.rotation.y, child.rotation.z],\n          };\n        })\n        .filter(Boolean);\n    }\n\n    function saveFurnitureLayout() {\n      if (\n        typeof window === \"undefined\" ||\n        !furnitureGroupRef.current ||\n        !window.localStorage\n      )\n        return;\n      const layout = getCurrentLayout();\n      try {\n        window.localStorage.setItem(LAYOUT_KEY, JSON.stringify(layout));\n      } catch (err) {\n        console.warn(\"Failed to save layout\", err);\n      }\n    }\n\n    function createFurnitureMesh(type) {\n      let mesh = null;\n      if (type === \"sofa\") {\n        const height = 0.7;\n        mesh = new THREE.Mesh(\n          new THREE.BoxGeometry(1.5, height, 0.6),\n          new THREE.MeshStandardMaterial({\n            color: 0x6cb2ff,\n            roughness: 0.4,\n          })\n        );\n        mesh.userData.floorOffset = height / 2;\n      } else if (type === \"table\") {\n        const height = 0.4;\n        mesh = new THREE.Mesh(\n          new THREE.BoxGeometry(0.9, height, 0.9),\n          new THREE.MeshStandardMaterial({\n            color: 0xffd37a,\n            roughness: 0.3,\n          })\n        );\n        mesh.userData.floorOffset = height / 2;\n      } else if (type === \"plant\") {\n        const potHeight = 0.35;\n        const pot = new THREE.Mesh(\n          new THREE.CylinderGeometry(0.2, 0.25, potHeight, 20),\n          new THREE.MeshStandardMaterial({ color: 0xa66a3d })\n        );\n        pot.position.y = potHeight / 2;\n        const leaves = new THREE.Mesh(\n          new THREE.ConeGeometry(0.4, 0.8, 24),\n          new THREE.MeshStandardMaterial({ color: 0x4ade80 })\n        );\n        leaves.position.y = potHeight + 0.4;\n        mesh = new THREE.Group();\n        mesh.add(pot);\n        mesh.add(leaves);\n        mesh.userData.floorOffset = FLOOR_Y;\n      }\n      if (mesh) {\n        mesh.userData.furnitureType = type;\n        const floorY = FLOOR_Y + (mesh.userData.floorOffset || 0);\n        mesh.position.y = floorY;\n        mesh.userData.floorY = floorY;\n      }\n      return mesh;\n    }\n\n    function getDefaultPosition(type) {\n      if (type === \"sofa\") {\n        return new THREE.Vector3(roomCenter.x - 0.6, FLOOR_Y, roomCenter.z);\n      }\n      if (type === \"table\") {\n        return new THREE.Vector3(roomCenter.x + 0.4, FLOOR_Y, roomCenter.z);\n      }\n      if (type === \"plant\") {\n        return new THREE.Vector3(roomCenter.x, FLOOR_Y, roomCenter.z + 0.7);\n      }\n      return roomCenter.clone();\n    }\n\n    function spawnFurniture(type, options = {}) {\n      if (!furnitureGroupRef.current) return null;\n      const mesh = createFurnitureMesh(type);\n      if (!mesh) return null;\n\n      const position = options.position\n        ? new THREE.Vector3(...options.position)\n        : getDefaultPosition(type);\n      mesh.position.x = position.x;\n      mesh.position.z = position.z;\n      mesh.position.y =\n        options.position?.[1] ??\n        (mesh.userData.floorY ?? FLOOR_Y + (mesh.userData.floorOffset || 0));\n\n      if (options.rotation) {\n        mesh.rotation.set(\n          options.rotation[0],\n          options.rotation[1],\n          options.rotation[2]\n        );\n      }\n\n      furnitureGroupRef.current.add(mesh);\n      return mesh;\n    }\n\n    function removeFurniture(mesh) {\n      if (!mesh || !furnitureGroupRef.current) return;\n      furnitureGroupRef.current.remove(mesh);\n      mesh.traverse?.((obj) => {\n        if (obj.isMesh) {\n          obj.geometry?.dispose?.();\n          if (Array.isArray(obj.material)) {\n            obj.material.forEach((mat) => mat?.dispose?.());\n          } else {\n            obj.material?.dispose?.();\n          }\n        }\n      });\n      mesh.geometry?.dispose?.();\n      if (Array.isArray(mesh.material)) {\n        mesh.material.forEach((mat) => mat?.dispose?.());\n      } else {\n        mesh.material?.dispose?.();\n      }\n    }\n\n    function clearFurniture() {\n      if (!furnitureGroupRef.current) return;\n      const group = furnitureGroupRef.current;\n      while (group.children.length) {\n        removeFurniture(group.children[0]);\n      }\n      saveFurnitureLayout();\n    }\n\n    function loadFurnitureLayout() {\n      if (typeof window === \"undefined\" || !window.localStorage) return;\n      try {\n        const raw = window.localStorage.getItem(LAYOUT_KEY);\n        if (!raw) return;\n        const layout = JSON.parse(raw);\n        layout.forEach((item) => {\n          const mesh = spawnFurniture(item.type, {\n            position: item.position,\n            rotation: item.rotation,\n          });\n          if (mesh) {\n            mesh.userData.floorY =\n              item.position?.[1] ??\n              (mesh.userData.floorY ||\n                FLOOR_Y + (mesh.userData.floorOffset || 0));\n          }\n        });\n      } catch (err) {\n        console.warn(\"Failed to load layout\", err);\n      }\n    }\n\n    // -----------------------\n    // Cloud save/load helpers\n    // -----------------------\n    async function saveLayoutToCloud() {\n      try {\n        const layout = getCurrentLayout();\n        await fetch(\"/api/save-layout\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            room_id: ROOM_ID,\n            layout,\n          }),\n        });\n        // optional: also keep local copy in localStorage\n        saveFurnitureLayout();\n        alert(\"Layout saved to cloud ‚úÖ\");\n      } catch (err) {\n        console.error(\"Failed to save layout to cloud\", err);\n        alert(\"Error saving layout to cloud\");\n      }\n    }\n\n    async function loadLayoutFromCloud() {\n      try {\n        const res = await fetch(\n          `/api/load-layout?room_id=${encodeURIComponent(ROOM_ID)}`\n        );\n        if (!res.ok) {\n          console.error(\"Cloud load failed\", await res.text());\n          alert(\"Error loading layout from cloud\");\n          return;\n        }\n        const data = await res.json();\n        if (!data.layout) {\n          alert(\"No saved layout found in cloud yet\");\n          return;\n        }\n\n        clearFurniture();\n        data.layout.forEach((item) => {\n          spawnFurniture(item.type, {\n            position: item.position,\n            rotation: item.rotation,\n          });\n        });\n\n        saveFurnitureLayout(); // sync to local\n        alert(\"Layout loaded from cloud ‚úÖ\");\n      } catch (err) {\n        console.error(\"Failed to load layout from cloud\", err);\n        alert(\"Error loading layout from cloud\");\n      }\n    }\n\n    // expose helpers to React buttons\n    furnitureHelpersRef.current = {\n      addSofa: () => {\n        const mesh = spawnFurniture(\"sofa\");\n        if (mesh) saveFurnitureLayout();\n      },\n      addTable: () => {\n        const mesh = spawnFurniture(\"table\");\n        if (mesh) saveFurnitureLayout();\n      },\n      addPlant: () => {\n        const mesh = spawnFurniture(\"plant\");\n        if (mesh) saveFurnitureLayout();\n      },\n      clearFurniture,\n      saveCloud: saveLayoutToCloud,\n      loadCloud: loadLayoutFromCloud,\n    };\n\n    // -----------------------\n    // Controls & model loading\n    // -----------------------\n    const controls = new OrbitControls(camera, renderer.domElement);\n    controlsRef.current = controls;\n    controls.enableDamping = true;\n    controls.dampingFactor = 0.05;\n    controls.enablePan = true;\n    controls.maxPolarAngle = Math.PI / 2.05;\n    controls.minDistance = 1;\n    controls.maxDistance = 50;\n\n    const loader = new GLTFLoader();\n    loader.load(\n      file,\n      (gltf) => {\n        gltf.scene.scale.set(1, 1, 1);\n        gltf.scene.position.set(0, 0, 0);\n        scene.add(gltf.scene);\n\n        const box = new THREE.Box3().setFromObject(gltf.scene);\n        const size = box.getSize(new THREE.Vector3()).length();\n        const center = box.getCenter(new THREE.Vector3());\n        roomCenter = center.clone();\n\n        controls.target.copy(center);\n        camera.position.set(\n          center.x + size * 0.6,\n          center.y + size * 0.3, // eye-ish height\n          center.z + size * 0.6\n        );\n        camera.lookAt(center);\n\n        // once the room is loaded, restore any saved furniture\n        loadFurnitureLayout();\n      },\n      (xhr) => {\n        if (xhr.total) {\n          const percent = ((xhr.loaded / xhr.total) * 100).toFixed(1);\n          console.log(`Loading model: ${percent}%`);\n        }\n      },\n      (error) => {\n        console.error(\"Failed to load GLB model:\", error);\n        // still try to load layout in case we want to handle fallback later\n        loadFurnitureLayout();\n      }\n    );\n\n    // -----------------------\n    // Interaction handlers\n    // -----------------------\n    const handleResize = () => {\n      const newWidth = container.clientWidth || window.innerWidth;\n      const newHeight = container.clientHeight || window.innerHeight;\n      camera.aspect = newWidth / newHeight;\n      camera.updateProjectionMatrix();\n      renderer.setSize(newWidth, newHeight);\n    };\n\n    window.addEventListener(\"resize\", handleResize);\n\n    function updatePointer(event) {\n      const rect = renderer.domElement.getBoundingClientRect();\n      pointer.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\n      pointer.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\n    }\n\n    function findFurnitureRoot(object) {\n      let current = object;\n      while (current) {\n        if (current.userData?.furnitureType) return current;\n        current = current.parent;\n      }\n      return null;\n    }\n\n    const handlePointerDown = (event) => {\n      if (!furnitureGroupRef.current) return;\n      updatePointer(event);\n      raycaster.setFromCamera(pointer, camera);\n      const intersects = raycaster.intersectObjects(\n        furnitureGroupRef.current.children,\n        true\n      );\n      if (intersects.length > 0) {\n        const root = findFurnitureRoot(intersects[0].object);\n        if (root) {\n          selectedFurniture = root;\n          isDragging = true;\n          controls.enabled = false;\n        } else {\n          selectedFurniture = null;\n          isDragging = false;\n        }\n      } else {\n        selectedFurniture = null;\n        isDragging = false;\n      }\n    };\n\n    const handlePointerMove = (event) => {\n      if (!isDragging || !selectedFurniture) return;\n      updatePointer(event);\n      raycaster.setFromCamera(pointer, camera);\n      const intersectionPoint = new THREE.Vector3();\n      if (raycaster.ray.intersectPlane(dragPlane, intersectionPoint)) {\n        selectedFurniture.position.x = intersectionPoint.x;\n        selectedFurniture.position.z = intersectionPoint.z;\n        const floorY = selectedFurniture.userData?.floorY;\n        if (typeof floorY === \"number\") {\n          selectedFurniture.position.y = floorY;\n        }\n      }\n    };\n\n    const endDrag = () => {\n      if (!isDragging) return;\n      isDragging = false;\n      controls.enabled = true;\n      if (selectedFurniture) {\n        saveFurnitureLayout();\n      }\n    };\n\n    const handlePointerUp = () => {\n      endDrag();\n    };\n\n    const handlePointerLeave = () => {\n      endDrag();\n    };\n\n    const handleKeyDown = (event) => {\n      if (\n        (event.key === \"Delete\" || event.key === \"Backspace\") &&\n        selectedFurniture\n      ) {\n        removeFurniture(selectedFurniture);\n        selectedFurniture = null;\n        saveFurnitureLayout();\n        return;\n      }\n\n      const rotateLeft =\n        event.key === \"q\" ||\n        event.key === \"Q\" ||\n        event.key === \"ArrowLeft\";\n      const rotateRight =\n        event.key === \"e\" ||\n        event.key === \"E\" ||\n        event.key === \"ArrowRight\";\n\n      if (selectedFurniture && (rotateLeft || rotateRight)) {\n        const delta = rotateLeft ? -ROTATION_STEP : ROTATION_STEP;\n        selectedFurniture.rotation.y += delta;\n        saveFurnitureLayout();\n        return;\n      }\n\n      if (\n        (event.key === \"l\" || event.key === \"L\") &&\n        (event.metaKey || event.ctrlKey) &&\n        event.shiftKey\n      ) {\n        const layout = getCurrentLayout();\n        const json = JSON.stringify(layout, null, 2);\n        console.log(\"[Lou-re] furniture layout:\\n\", json);\n        if (navigator?.clipboard?.writeText) {\n          navigator.clipboard.writeText(json).catch(() => {});\n        }\n        event.preventDefault();\n      }\n    };\n\n    renderer.domElement.addEventListener(\"pointerdown\", handlePointerDown);\n    renderer.domElement.addEventListener(\"pointermove\", handlePointerMove);\n    renderer.domElement.addEventListener(\"pointerup\", handlePointerUp);\n    renderer.domElement.addEventListener(\"pointerleave\", handlePointerLeave);\n    window.addEventListener(\"keydown\", handleKeyDown);\n\n    let animationFrame;\n    const animate = () => {\n      controls.update();\n      renderer.render(scene, camera);\n      animationFrame = requestAnimationFrame(animate);\n    };\n    animate();\n\n    return () => {\n      cancelAnimationFrame(animationFrame);\n      window.removeEventListener(\"resize\", handleResize);\n      window.removeEventListener(\"keydown\", handleKeyDown);\n      renderer.domElement.removeEventListener(\"pointerdown\", handlePointerDown);\n      renderer.domElement.removeEventListener(\"pointermove\", handlePointerMove);\n      renderer.domElement.removeEventListener(\"pointerup\", handlePointerUp);\n      renderer.domElement.removeEventListener(\n        \"pointerleave\",\n        handlePointerLeave\n      );\n      controls.dispose();\n      renderer.dispose();\n      if (container && container.contains(renderer.domElement)) {\n        container.removeChild(renderer.domElement);\n      }\n      clearFurniture();\n      furnitureHelpersRef.current = {\n        addSofa: null,\n        addTable: null,\n        addPlant: null,\n        clearFurniture: null,\n        saveCloud: null,\n        loadCloud: null,\n      };\n      furnitureGroupRef.current = null;\n    };\n  }, [file]);\n\n  return (\n    <div\n      style={{\n        position: \"relative\",\n        width: \"100%\",\n        height: \"100vh\",\n        overflow: \"hidden\",\n        background: \"#000\",\n      }}\n    >\n      <div\n        ref={containerRef}\n        style={{\n          width: \"100%\",\n          height: \"100%\",\n          overflow: \"hidden\",\n          background: \"#000\",\n          cursor: \"grab\",\n        }}\n      />\n      <div\n        className=\"louref-toolbar\"\n        style={{\n          position: \"absolute\",\n          right: \"16px\",\n          top: \"80px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"8px\",\n          padding: \"12px\",\n          borderRadius: \"12px\",\n          background: \"rgba(10, 10, 10, 0.9)\",\n          color: \"#fff\",\n          fontSize: \"13px\",\n          maxWidth: \"240px\",\n          zIndex: 10,\n        }}\n      >\n        <div style={{ fontWeight: 600, marginBottom: \"4px\" }}>\n          Furniture tools\n        </div>\n        <div style={{ opacity: 0.8, marginBottom: \"8px\" }}>\n          Click to drop furniture. Click an item to select, drag to move, use\n          Q/E or ‚Üê/‚Üí to rotate, press Delete to remove, and press Ctrl/‚åò + Shift\n          + L to copy layout JSON.\n        </div>\n        <button\n          onClick={() => furnitureHelpersRef.current.addSofa?.()}\n          style={toolbarButtonStyle}\n        >\n          + Add sofa (box)\n        </button>\n        <button\n          onClick={() => furnitureHelpersRef.current.addTable?.()}\n          style={toolbarButtonStyle}\n        >\n          + Add table (box)\n        </button>\n        <button\n          onClick={() => furnitureHelpersRef.current.addPlant?.()}\n          style={toolbarButtonStyle}\n        >\n          + Add plant (cylinder + cone)\n        </button>\n\n        <hr style={{ borderColor: \"#333\", margin: \"6px 0\" }} />\n\n        <button\n          onClick={() => furnitureHelpersRef.current.saveCloud?.()}\n          style={toolbarButtonStyle}\n        >\n          üíæ Save layout to cloud\n        </button>\n        <button\n          onClick={() => furnitureHelpersRef.current.loadCloud?.()}\n          style={toolbarButtonStyle}\n        >\n          ‚òÅÔ∏è Load layout from cloud\n        </button>\n\n        <button\n          onClick={() => furnitureHelpersRef.current.clearFurniture?.()}\n          style={{\n            ...toolbarButtonStyle,\n            marginTop: \"4px\",\n            border: \"1px solid #555\",\n            background: \"#220000\",\n            color: \"#ffb3b3\",\n          }}\n        >\n          Clear all furniture\n        </button>\n      </div>\n    </div>\n  );\n}\n\nconst toolbarButtonStyle = {\n  padding: \"6px 10px\",\n  borderRadius: \"8px\",\n  border: \"1px solid #333\",\n  background: \"#111\",\n  color: \"#fff\",\n  cursor: \"pointer\",\n  textAlign: \"left\",\n};"],"names":[],"mappings":"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"}}]
}